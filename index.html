<h1>GoogleSewer</h1>

<form id="search-form">
  <input type="text" id="search-input" placeholder="Sewage Search..." />
  <button type="submit">Flush</button>
</form>

<div id="results"></div>

<script>
  document.getElementById("search-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    const query = document.getElementById("search-input").value;
    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "<p>Scraping the Sewer...</p>";

    try {
      const res = await fetch(`/.netlify/functions/search?q=${encodeURIComponent(query)}`);
      const data = await res.json();
      resultsDiv.innerHTML = "";

      if (data.results && data.results.length > 0) {
        data.results.forEach((result) => {
          const resultHTML = `
            <div style="margin-bottom: 1rem; border-bottom: 1px solid #ccc;">
              <h3><a href="${result.link}" target="_blank">${result.title}</a></h3>
              <p>${result.snippet || ''}</p>
              <small>Score: ${result.score}</small>
            </div>
          `;
          resultsDiv.innerHTML += resultHTML;
        });
      } else {
        resultsDiv.innerHTML = "<p>No sewage found.</p>";
      }
    } catch (err) {
      resultsDiv.innerHTML = `<p>Error dragging the net: ${err.message}</p>`;
    }
  });
</script>



